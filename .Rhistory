# cannot get nls method to compute with
# asymp formula
#method = "gam",
#formula = y ~ s(x, bs = "cs"),
method = "nls",
formula = y ~ a - b * exp(-c*x),
method.args = list(
start = list(
a = 20,
b = 16,
c = 0.0039
)
#formula = a - b * exp(-c*x)
),
se = F,
aes(
x = Day,
y = .fitted,
a = 20,
b = 16,
c = 0.0039
),
colour = "black"
) + ylab(
"Male spot brightness"
)+ labs(
caption = str_wrap("Increase in male guppy spot brightness over time when populations were not exposed to predation (lifespan around 120 days). Each data point represents the spot brightness of one male guppy (points are jittered around both x and y values). The curve shown has been fitted using asymptotic growth equation (y = a - b * exp(-c*x)) from all substrates and feeding levels (no differences between these factors were observed).", width = 100)
)
fit_control_asymp %>%
augment() %>%
ggplot(
.,
aes(
y = Spot.brightness,
x = Day
),
ylim = c(0,20)
) + ylim(
0, 20
) + geom_jitter(
pch = roses_unicode("dot_closed"),
size = 1.5,
width = 25,
height = .25,
alpha = .3
) + geom_smooth(
# gam method and formula matches nls fit
# when .fitted included in aes.
# cannot get nls method to compute with
# asymp formula
method = "gam",
formula = y ~ s(x, bs = "cs"),
# method = "nls",
# formula = y ~ a - b * exp(-c*x),
# method.args = list(
#   start = list(
#     a = 20,
#     b = 16,
#     c = 0.0039
#   )
# ),
se = F,
aes(
x = Day,
y = .fitted,
a = 20,
b = 16,
c = 0.0039
),
colour = "black"
) + ylab(
"Male spot brightness"
)+ labs(
caption = str_wrap("Increase in male guppy spot brightness over time when populations were not exposed to predation (lifespan around 120 days). Each data point represents the spot brightness of one male guppy (points are jittered around both x and y values). The curve shown has been fitted using asymptotic growth equation (y = a - b * exp(-c*x)) from all substrates and feeding levels (no differences between these factors were observed).", width = 100)
)
fit_control_asymp %>%
augment() %>%
ggplot(
.,
aes(
y = Spot.brightness,
x = Day
),
ylim = c(0,20)
) + ylim(
0, 20
) + geom_jitter(
pch = roses_unicode("dot_closed"),
size = 1.5,
width = 25,
height = .25,
alpha = .3
) + geom_smooth(
# gam method and formula matches nls fit
# when .fitted included in aes.
# cannot get nls method to compute with
# asymp formula
method = "gam",
formula = y ~ s(x, bs = "cs"),
# method = "nls",
# formula = y ~ a - b * exp(-c*x),
# method.args = list(
#   start = list(
#     a = 20,
#     b = 16,
#     c = 0.0039
#   )
# ),
se = F,
aes(
x = Day,
y = .fitted
),
colour = "black"
) + ylab(
"Male spot brightness"
)+ labs(
caption = str_wrap("Increase in male guppy spot brightness over time when populations were not exposed to predation (lifespan around 120 days). Each data point represents the spot brightness of one male guppy (points are jittered around both x and y values). The curve shown has been fitted using asymptotic growth equation (y = a - b * exp(-c*x)) from all substrates and feeding levels (no differences between these factors were observed).", width = 100)
)
fit_control_asymp %>%
augment() %>%
ggplot(
.,
aes(
y = Spot.brightness,
x = Day
),
ylim = c(0,21)
) + ylim(
0, 20
) + geom_jitter(
pch = roses_unicode("dot_closed"),
size = 1.5,
width = 25,
height = .25,
alpha = .3
) + geom_smooth(
# gam method and formula matches nls fit
# when .fitted included in aes.
# cannot get nls method to compute with
# asymp formula
method = "gam",
formula = y ~ s(x, bs = "cs"),
# method = "nls",
# formula = y ~ a - b * exp(-c*x),
# method.args = list(
#   start = list(
#     a = 20,
#     b = 16,
#     c = 0.0039
#   )
# ),
se = F,
aes(
x = Day,
y = .fitted
),
colour = "black"
) + ylab(
"Male spot brightness"
)+ labs(
caption = str_wrap("Increase in male guppy spot brightness over time when populations were not exposed to predation (lifespan around 120 days). Each data point represents the spot brightness of one male guppy (points are jittered around both x and y values). The curve shown has been fitted using asymptotic growth equation (y = a - b * exp(-c*x)) from all substrates and feeding levels (no differences between these factors were observed).", width = 100)
)
fit_control_asymp %>%
augment() %>%
ggplot(
.,
aes(
y = Spot.brightness,
x = Day
)
) + ylim(
0, 21
) + geom_jitter(
pch = roses_unicode("dot_closed"),
size = 1.5,
width = 25,
height = .25,
alpha = .3
) + geom_smooth(
# gam method and formula matches nls fit
# when .fitted included in aes.
# cannot get nls method to compute with
# asymp formula
method = "gam",
formula = y ~ s(x, bs = "cs"),
# method = "nls",
# formula = y ~ a - b * exp(-c*x),
# method.args = list(
#   start = list(
#     a = 20,
#     b = 16,
#     c = 0.0039
#   )
# ),
se = F,
aes(
x = Day,
y = .fitted
),
colour = "black"
) + ylab(
"Male spot brightness"
)+ labs(
caption = str_wrap("Increase in male guppy spot brightness over time when populations were not exposed to predation (lifespan around 120 days). Each data point represents the spot brightness of one male guppy (points are jittered around both x and y values). The curve shown has been fitted using asymptotic growth equation (y = a - b * exp(-c*x)) from all substrates and feeding levels (no differences between these factors were observed).", width = 100)
)
use_build_ignore("analysis*", escape = T)
usethis::use_build_ignore("analysis*", escape = T)
#+ data ----------------------------------------------
load("data/guppies.rda")
devtools::install("./")
?roses_par
roses_par()
devtools::install_local("./")
devtools::install_local("./")
roses_par
roses_par()
guppies::roses_par()
data("guppies::guppies")
data("guppies")
#' @title Control group spot brightness curve
plot_guppies_control <- function(){
# load the data
data("guppies")
# subset the data
control <- guppies %>%
filter(Predation == FALSE)
# fit the growth curve
fit_control <- nls(
Spot.brightness ~ a - b*exp(-c*Day),
data = control,
start = list(
a = 20, # asymptotic val of function (plataeu)
b = 16, # a - intercept at 0
c = 0.0039 # -log((20-14)/16)/250)
)
)
# build the plot
plot <- fit_control %>% augment() %>%
ggplot(
.,
aes(
y = Spot.brightness,
x = Day
)
) + ylim(
0, 21 # has to include jitter range
) + geom_jitter(
pch = roses_unicode("dot_closed"),
size = 1.5,
width = 25,
height = .25,
alpha = .3
) + geom_smooth(
# gam method and formula matches nls fit
# when .fitted included in aes.
# cannot get nls method to compute with
# asymp formula
method = "gam",
formula = y ~ s(x, bs = "cs"),
# method = "nls",
# formula = y ~ a - b * exp(-c*x),
# method.args = list(
#   start = list(
#     a = 20,
#     b = 16,
#     c = 0.0039
#   )
# ),
se = F,
aes(
x = Day,
y = .fitted
),
colour = "black"
) + ylab(
"Male spot brightness"
) + labs(
caption = str_wrap("Increase in male guppy spot brightness over time when populations were not exposed to predation (lifespan around 120 days). Each data point represents the spot brightness of one male guppy (points are jittered around both x and y values). The curve shown has been fitted using asymptotic growth equation (y = a - b * exp(-c*x)) from all substrates and feeding levels (no differences between these factors were observed).", width = 100)
)
# return plot
return(plot)
}
plot_guppies_control()
#' @title Control group spot brightness curve
plot_guppies_control <- function(){
# load the data
data("guppies")
# subset the data
control <- guppies %>%
filter(Predation == FALSE)
# fit the growth curve
fit_control <- nls(
Spot.brightness ~ a - b*exp(-c*Day),
data = control,
start = list(
a = 20, # asymptotic val of function (plataeu)
b = 16, # a - intercept at 0
c = 0.0039 # -log((20-14)/16)/250)
)
)
# build the plot
plot <- fit_control %>% augment() %>%
ggplot(
.,
aes(
y = Spot.brightness,
x = Day
)
) + ylim(
0, 21 # has to include jitter range
) + geom_jitter(
pch = guppies::roses_unicode("dot_closed"),
size = 1.5,
width = 25,
height = .25,
alpha = .3
) + geom_smooth(
# gam method and formula matches nls fit
# when .fitted included in aes.
# cannot get nls method to compute with
# asymp formula
method = "gam",
formula = y ~ s(x, bs = "cs"),
# method = "nls",
# formula = y ~ a - b * exp(-c*x),
# method.args = list(
#   start = list(
#     a = 20,
#     b = 16,
#     c = 0.0039
#   )
# ),
se = F,
aes(
x = Day,
y = .fitted
),
colour = "black"
) + ylab(
"Male spot brightness"
) + labs(
caption = str_wrap("Increase in male guppy spot brightness over time when populations were not exposed to predation (lifespan around 120 days). Each data point represents the spot brightness of one male guppy (points are jittered around both x and y values). The curve shown has been fitted using asymptotic growth equation (y = a - b * exp(-c*x)) from all substrates and feeding levels (no differences between these factors were observed).", width = 100)
)
# return plot
return(plot)
}
plot_guppies_control()
#' @title Rose's favourite unicodes
#' @desc These are all tried and tested as pch vals. Unicode characters work really nicely as pch vals with alpha transparency as they are one solid vector layer - the whole icon will be the same transparency and and will have nice high res smooth edges.
#' @param shorthand my nickname for the unicaode character
#' @return hexidecimal form of the unicode
#' @example roses_unicode("dot_open")
#' @example par(pch = roses_unicaode("dot_filled"))
roses_unicode <- function(shorthand){
if(shorthand == "dot_open")
code <- "25CB"
if(shorthand == "dot_filled")
code <- "25CF"
return(-as.hexmode(code))
}
#' @title Control group spot brightness curve
plot_guppies_control <- function(){
# load the data
data("guppies")
# subset the data
control <- guppies %>%
filter(Predation == FALSE)
# fit the growth curve
fit_control <- nls(
Spot.brightness ~ a - b*exp(-c*Day),
data = control,
start = list(
a = 20, # asymptotic val of function (plataeu)
b = 16, # a - intercept at 0
c = 0.0039 # -log((20-14)/16)/250)
)
)
# build the plot
plot <- fit_control %>% augment() %>%
ggplot(
.,
aes(
y = Spot.brightness,
x = Day
)
) + ylim(
0, 21 # has to include jitter range
) + geom_jitter(
pch = guppies::roses_unicode("dot_filled"),
size = 1.5,
width = 25,
height = .25,
alpha = .3
) + geom_smooth(
# gam method and formula matches nls fit
# when .fitted included in aes.
# cannot get nls method to compute with
# asymp formula
method = "gam",
formula = y ~ s(x, bs = "cs"),
# method = "nls",
# formula = y ~ a - b * exp(-c*x),
# method.args = list(
#   start = list(
#     a = 20,
#     b = 16,
#     c = 0.0039
#   )
# ),
se = F,
aes(
x = Day,
y = .fitted
),
colour = "black"
) + ylab(
"Male spot brightness"
) + labs(
caption = str_wrap("Increase in male guppy spot brightness over time when populations were not exposed to predation (lifespan around 120 days). Each data point represents the spot brightness of one male guppy (points are jittered around both x and y values). The curve shown has been fitted using asymptotic growth equation (y = a - b * exp(-c*x)) from all substrates and feeding levels (no differences between these factors were observed).", width = 100)
)
# return plot
return(plot)
}
plot_guppies_control()
#' @title Control group spot brightness curve
plot_control <- function(){
# load the data
data("guppies")
# subset the data
control <- guppies %>%
filter(Predation == FALSE)
# fit the growth curve
fit_control <- nls(
Spot.brightness ~ a - b*exp(-c*Day),
data = control,
start = list(
a = 20, # asymptotic val of function (plataeu)
b = 16, # a - intercept at 0
c = 0.0039 # -log((20-14)/16)/250)
)
)
# build the plot
plot <- fit_control %>% augment() %>%
ggplot(
.,
aes(
y = Spot.brightness,
x = Day
)
) + ylim(
0, 21 # has to include jitter range
) + geom_jitter(
pch = guppies::roses_unicode("dot_filled"),
size = 1.5,
width = 25,
height = .25,
alpha = .3
) + geom_smooth(
# gam method and formula matches nls fit
# when .fitted included in aes.
# cannot get nls method to compute with
# asymp formula
method = "gam",
formula = y ~ s(x, bs = "cs"),
# method = "nls",
# formula = y ~ a - b * exp(-c*x),
# method.args = list(
#   start = list(
#     a = 20,
#     b = 16,
#     c = 0.0039
#   )
# ),
se = F,
aes(
x = Day,
y = .fitted
),
colour = "black"
) + ylab(
"Male spot brightness"
) + labs(
caption = str_wrap("Increase in male guppy spot brightness over time when populations were not exposed to predation (lifespan around 120 days). Each data point represents the spot brightness of one male guppy (points are jittered around both x and y values). The curve shown has been fitted using asymptotic growth equation (y = a - b * exp(-c*x)) from all substrates and feeding levels (no differences between these factors were observed).", width = 100)
)
# return plot
return(plot)
}
devtools::install.local("./")
devtools::install_local("./")
devtools::install_local("./", force = T)
guppies::plot_control()
devtools::install_local("./", force = T)
guppies::plot_control()
guppies::roses_par()
devtools::install_local("./", force = T)
devtools::install_local("./", force = T)
devtools::install_local("./", force = T)
library(guppies)
plot_control()
plot_control() + labs( caption = "blah")
usethis::use_build_ignore("analysis",escape = T)
knitr::opts_chunk$set(echo = TRUE)
source("analysis/control.R")
source("analysis/control.R")
?exists
source("analysis/control.R")
source("analysis/control.R")
plot_control
source("analysis/setup.R")
source("analysis/control.R")
plot_control
